>> !cp examples/simdiag/*.m .
>> randn('state',0);
>> [A,B] = noisy;
>> parameters(A,B);
>> Y0 = guess;
>> [fn,Yn] = sg_min(Y0,'frcg','euclidean');  
iter    grad            F(Y)              flops
0       2.887592e+03    9.671138e+02        30940
1       1.419011e+03    2.411349e+02       343392
2       6.199732e+02    7.601495e+01       718792
3       3.051636e+02    3.300591e+01      1106535
4       2.538995e+02    2.078422e+01      1518380
5       1.440247e+02    1.258174e+01      1923273
6       1.189063e+02    9.500450e+00      2332153
7       9.279907e+01    7.309071e+00      2743897
8       8.483878e+01    6.093323e+00      3161294
9       7.763100e+01    4.117233e+00      3609412
10      7.448803e+01    3.220241e+00      4026633
11      6.404668e+01    2.328540e+00      4439092
12      4.628394e+01    1.660617e+00      4856444
13      4.016005e+01    1.273831e+00      5263924
14      2.513055e+01    1.081176e+00      5667986
15      2.890553e+01    9.638797e-01      6113749
16      2.907842e+01    8.048394e-01      6557599
17      3.030147e+01    6.052888e-01      6997870
18      2.376061e+01    4.140464e-01      7437280
19      1.737574e+01    3.574269e-01      7804852
20      1.320297e+01    2.987308e-01      8242042
21      1.199741e+01    2.640777e-01      8677581
22      1.449131e+01    2.355636e-01      9108186
23      1.190074e+01    2.026084e-01      9507456
24      9.917592e+00    1.690088e-01      9943594
25      8.665170e+00    1.569910e-01     10356330
26      7.504062e+00    1.415182e-01     10794718
27      9.186214e+00    1.262683e-01     11230418
28      8.125852e+00    1.149962e-01     11628258
29      6.534888e+00    1.024721e-01     12060862
30      7.431181e+00    8.943670e-02     12534789
31      7.646928e+00    8.136128e-02     12939667
32      5.410188e+00    7.087689e-02     13333943
33      6.643581e+00    6.517094e-02     13769366
34      8.702509e+00    4.927172e-02     14239276
35      6.580419e+00    3.897378e-02     14639905
36      5.507775e+00    3.281835e-02     15045120
37      5.912070e+00    2.684168e-02     15479652
38      5.454210e+00    1.877456e-02     15913877
39      3.336169e+00    1.455950e-02     16319807
40      2.332540e+00    1.347349e-02     16697326
41      1.882333e+00    1.220546e-02     17130544
42      2.008120e+00    1.155006e-02     17570085
43      1.524337e+00    1.100025e-02     17968479
44      1.760503e+00    1.033507e-02     18402266
45      1.911111e+00    9.797368e-03     18803756
46      1.067283e+00    9.525908e-03     19115848
47      1.053542e+00    9.242788e-03     19555861
48      1.260292e+00    8.932828e-03     19987428
49      1.225523e+00    8.687612e-03     20386874
50      1.206097e+00    8.343506e-03     20819785
51      1.454149e+00    7.872419e-03     21278041
52      2.437703e+00    6.770198e-03     21769133
53      1.702329e+00    5.840431e-03     22167235
54      1.662686e+00    5.153694e-03     22587496
55      1.526625e+00    4.629711e-03     23007716
56      1.464135e+00    3.951042e-03     23435371
57      1.512146e+00    3.314627e-03     23860701
58      1.267195e+00    2.749053e-03     24286922
59      9.920956e-01    2.183788e-03     24745601
60      1.176035e+00    1.883101e-03     25198028
61      1.378844e+00    1.480255e-03     25628090
62      1.057709e+00    1.245329e-03     26021898
63      7.888821e-01    1.060716e-03     26420584
64      7.751191e-01    9.017432e-04     26849628
65      7.322397e-01    7.339194e-04     27269058
66      7.955357e-01    6.234925e-04     27693658
67      5.111285e-01    5.424363e-04     28087466
68      4.335341e-01    4.467846e-04     28544625
69      6.331619e-01    3.513979e-04     29035732
70      5.566733e-01    2.940720e-04     29443519
71      2.220852e-01    1.990440e-04     29906477
72      2.592335e-01    1.772483e-04     30362176
73      2.367626e-01    1.545692e-04     30809156
74      3.458862e-01    1.410366e-04     31225052
75      4.211657e-01    1.053656e-04     31642015
76      2.565262e-01    8.499020e-05     32037006
77      1.393246e-01    7.158704e-05     32458218
78      1.748717e-01    5.472845e-05     32975677
79      3.124619e-01    3.715726e-05     33452608
80      1.949300e-01    2.352295e-05     33844166
81      1.474121e-01    1.885869e-05     34235062
82      9.233919e-02    1.208368e-05     34689447
83      1.056486e-01    1.047550e-05     35110936
84      8.587921e-02    7.666175e-06     35526671
85      7.616273e-02    6.455692e-06     35919311
86      7.004235e-02    2.870799e-06     36395376
87      5.403610e-02    2.155906e-06     36785781
88      5.900955e-02    1.395249e-06     37212470
89      2.053698e-02    1.109171e-06     37576493
90      2.106381e-02    9.140552e-07     38015192
91      1.382268e-02    8.304483e-07     38379198
92      1.641192e-02    7.711788e-07     38833336
93      1.920746e-02    7.211514e-07     39248945
94      1.504062e-02    6.590799e-07     39631683
95      1.332352e-02    5.975657e-07     40041125
96      1.353443e-02    5.600185e-07     40447954
97      1.010672e-02    5.098528e-07     40860155
98      1.078178e-02    4.910061e-07     41248939
99      1.046154e-02    4.591050e-07     41658044
100     6.970336e-03    4.436294e-07     42038884
101     6.866709e-03    4.335869e-07     42443302
102     6.671327e-03    4.246612e-07     42854159
103     3.432481e-03    4.185427e-07     43233393
104     4.050392e-03    4.151384e-07     43639215
105     2.430931e-03    4.114516e-07     44045984
106     2.719997e-03    4.083673e-07     44514939
107     1.721370e-03    4.071294e-07     44892462
108     1.773014e-03    4.059244e-07     45319859
109     1.727884e-03    4.049352e-07     45733358
110     1.128442e-03    4.027588e-07     46185093
111     5.667955e-04    4.020315e-07     46639456
112     6.811113e-04    4.019335e-07     47053346
113     6.373107e-04    4.018780e-07     47403392
114     5.043844e-04    4.016303e-07     47847752
115     4.080178e-04    4.015292e-07     48264404
116     4.210846e-04    4.014493e-07     48669056
117     5.012412e-04    4.013891e-07     49076443
118     4.929201e-04    4.013514e-07     49423348
119     2.431143e-04    4.013046e-07     49802387
120     4.808637e-04    4.012737e-07     50222201
121     3.116733e-04    4.012390e-07     50563583
122     2.817088e-04    4.011840e-07     50991286
123     2.860332e-04    4.011426e-07     51419378
124     2.753330e-04    4.011266e-07     51784643
125     1.858210e-04    4.011107e-07     52153993
126     1.072727e-04    4.010939e-07     52575473
127     1.263155e-04    4.010876e-07     52999820
128     1.228033e-04    4.010846e-07     53331488
129     1.257962e-04    4.010815e-07     53693736
130     4.719428e-05    4.010800e-07     53999075
131     6.192254e-05    4.010791e-07     54367596
132     3.205761e-05    4.010784e-07     54695116
133     6.446538e-05    4.010777e-07     55085234
134     3.775412e-05    4.010765e-07     55437723
135     8.762023e-05    4.010750e-07     55857251
136     3.002123e-05    4.010744e-07     56078871
137     2.641275e-05    4.010743e-07     56406006
138     3.477202e-05    4.010733e-07     56852339
139     4.878411e-05    4.010730e-07     57221436
140     4.474522e-05    4.010721e-07     57595456
141     2.804804e-05    4.010719e-07     57901570
142     4.266686e-05    4.010715e-07     58291559
143     3.350553e-05    4.010712e-07     58638910
144     6.093956e-05    4.010707e-07     59008745
145     4.994938e-05    4.010702e-07     59336309
146     6.968500e-05    4.010691e-07     59708329
147     4.519545e-05    4.010681e-07     60059883
148     3.412725e-05    4.010676e-07     60409231
149     2.814751e-05    4.010671e-07     60801903
150     2.464824e-05    4.010667e-07     61171146
151     1.844277e-05    4.010665e-07     61539831
152     2.001241e-05    4.010665e-07     61886666
153     1.337071e-05    4.010664e-07     62212677
154     1.616449e-05    4.010664e-07     62559229
155     1.222359e-05    4.010663e-07     62906130
156     8.744297e-06    4.010663e-07     63252521
157     1.038597e-05    4.010662e-07     63641285
158     8.162439e-06    4.010662e-07     64008384
159     5.546927e-06    4.010662e-07     64396492
160     1.091517e-05    4.010661e-07     64764089
161     8.651472e-06    4.010661e-07     65089501
162     4.808916e-06    4.010661e-07     65457038
163     5.925477e-06    4.010661e-07     65824968
164     5.718853e-06    4.010661e-07     66151185
165     4.912430e-06    4.010661e-07     66498232
166     5.752085e-06    4.010661e-07     66865492
167     5.288075e-06    4.010661e-07     67212813
168     3.278015e-06    4.010660e-07     67516724
169     2.196881e-06    4.010660e-07     67843218
170     2.309773e-06    4.010660e-07     68212219
171     2.435095e-06    4.010660e-07     68558476
172     1.763263e-06    4.010660e-07     68946596
173     2.081518e-06    4.010660e-07     69314166
174     1.251419e-06    4.010660e-07     69639992
175     1.474565e-06    4.010660e-07     70028565
176     8.949991e-07    4.010660e-07     70353929
177     8.506853e-07    4.010660e-07     70742988
178     7.154996e-07    4.010660e-07     71068090
179     8.003997e-07    4.010660e-07     71395085
180     3.164977e-07    4.010660e-07     71721113
181     3.701357e-07    4.010660e-07     72030590
>> fn

fn =

   4.0107e-07
